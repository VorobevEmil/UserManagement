@using UserManagement.Client.Services.Authorization
<AuthorizeView>
    <Authorized>
        <MudText>Привет @(context.User.Identity!.Name)!</MudText>
        <span class="mx-2"></span>
        <MudButton StartIcon="@Icons.Filled.ExitToApp" Color="Color.Secondary" Variant="Variant.Filled" OnClick="LogoutAsync">Выход</MudButton>
    </Authorized>
    <NotAuthorized>
        <style>
            .mud-primary-text {
                color: white !important;
            }
        </style>
        <MudLink Href="Account/Login">Войти</MudLink>
        <span class="mx-2"></span>
        <MudLink Href="Account/Register">Регистрация</MudLink>
    </NotAuthorized>
</AuthorizeView>

@code {
    [Inject] private HostAuthenticationStateProvider HostAuthenticationStateProvider { get; set; } = default!;
    [CascadingParameter] public MainLayout Parent { get; set; } = default!;

    private async Task LogoutAsync()
    {
        await HttpClient.PostAsync("api/Account/Logout", null);
        HostAuthenticationStateProvider.RefreshState();
        await Parent.RefreshStateAsync();
    }
}